(()=>{"use strict";var t=[{label:"Streets",styleName:"Mapbox Streets",styleUrl:"mapbox://styles/mapbox/streets-v11"},{label:"Satellite",styleName:"Mapbox Satellite Streets",styleUrl:"mapbox://sprites/mapbox/satellite-streets-v11"}],e=function(e){void 0===e&&(e={}),this.styles=e.styles||t,this.onChange=e.onChange};e.prototype.insertControls=function(){var t=this;this.container=document.createElement("div"),this.container.classList.add("mapboxgl-ctrl"),this.container.classList.add("mapboxgl-ctrl-group"),this.container.classList.add("mapboxgl-ctrl-styles"),this.nodes=[],this.styles.forEach(function(e){var o=document.createElement("button");o.setAttribute("type","button"),o.textContent=e.label,o.addEventListener("click",function(){o.classList.contains("-active")||(t.map.setStyle(e.styleUrl),t.onChange&&t.onChange(e))}),t.nodes.push(o),t.container.appendChild(o)})},e.prototype.onAdd=function(t){var e=this;return this.map=t,this.insertControls(),this.map.on("styledata",function(){[].forEach.call(e.container.querySelectorAll("button"),function(t){t.classList.remove("-active")});var t=e.styles.map(function(t){return t.styleName}).indexOf(e.map.getStyle().name);-1!==t&&e.nodes[t].classList.add("-active")}),this.container},e.prototype.onRemove=function(){this.container.parentNode.removeChild(this.container),this.map=void 0};const o=e;mapboxgl.accessToken="pk.eyJ1IjoibmRvaXJvbjIiLCJhIjoiY2o0ZzkzamN0MDFnNTMycW53cWxocjZmeiJ9.JromgSz8YMJodPRTanfspQ";var a=new mapboxgl.Map({container:"map",style:"mapbox://styles/mapbox/light-v11",center:[121.058,23.695],zoom:7,hash:!0});a.addControl(new o({styles:[{label:"Streets",styleName:"Streets",styleUrl:"mapbox://styles/mapbox/light-v11"},{label:"Satellite",styleName:"Satellite",styleUrl:"mapbox://styles/mapbox/satellite-streets-v12"}],onChange:t=>{}}),"top-left"),a.addControl(new mapboxgl.NavigationControl,"bottom-right"),a.addControl(new mapboxgl.GeolocateControl({positionOptions:{enableHighAccuracy:!0},trackUserLocation:!0}),"bottom-right"),a.addControl(new MapboxGeocoder({accessToken:mapboxgl.accessToken,mapboxgl,countries:"TW"})),a.fitBounds([[118.01,21.64],[122.48,25.87]]),document.getElementById("edit-map").onclick=function(){window.open(`https://www.openstreetmap.org/edit?editor=id#map=${a.getZoom()}/${a.getCenter().lngLat.lat}/${a.getCenter().lngLat.lng}`)},a.on("load",function(){a.on("mouseenter","changesets",function(){a.getCanvas().style.cursor="pointer"}),a.on("mouseleave","changesets",function(){a.getCanvas().style.cursor=""}),a.on("click","changesets",function(t){console.log(t.features);const e=t.features[0];var o=t.lngLat.toArray(),n=t.lngLat.lng,s=t.lngLat.lat,l=.05,r=[n+l,s-l,n-l,s+l].join(","),i=([n-l,s-l,n+l,s+l].join(","),`<b>${e.properties.changes}</b> changes by ${e.properties.user}`);for(i+=`<p>${e.properties.comment}</p>`,i+=`<br><a href='https://osmcha.org/filters?filters={"in_bbox":[{"label":"${r}","value":"${r}"}],"area_lt":[{"label":"10","value":"10"}]}'>Check neighbourhood acitivy with OSMCha</a>`,i+=`<br><a href='https://www.openstreetmap.org/history#map=14/${t.lngLat.lat}/${t.lngLat.lng}'>OSM History</a>`;Math.abs(t.lngLat.lng-o[0])>180;)o[0]+=t.lngLat.lng>o[0]?360:-360;document.getElementById("map-overlay").innerHTML=i,(new mapboxgl.Popup).setLngLat(o).setHTML(i).addTo(a)})})})();